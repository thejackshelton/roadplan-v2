const k=(T,b)=>{const t=window,l="_qRouterSPA",h="_qRouterInitPopstate",d="_qRouterInitAnchors",f="_qRouterInitVisibility",p="_qRouterInitScroll";if(!t[l]&&!t[h]&&!t[d]&&!t[f]&&!t[p]){const R=location.pathname+location.search,y="_qRouterHistoryPatch",_="_qRouterBootstrap",s="_qRouterScrollEnabled",a="_qRouterScrollDebounce",S="_qRouterScroll",v=o=>{o&&t.scrollTo(o.x,o.y)},m=()=>{const o=document.documentElement;return{x:o.scrollLeft,y:o.scrollTop,w:Math.max(o.scrollWidth,o.clientWidth),h:Math.max(o.scrollHeight,o.clientHeight)}},u=o=>{const r=history.state||{};r[S]=o||m(),history.replaceState(r,"")};if(u(),t[h]=()=>{var o,r;if(!t[l]){if(t[s]=!1,clearTimeout(t[a]),R!==location.pathname+location.search){const c=n=>n.closest("[q\\:container]:not([q\\:container=html]):not([q\\:container=text])"),e=(o=c(b))==null?void 0:o.querySelector("a[q\\:link]");if(e){const n=c(e),i=e.cloneNode();i.setAttribute("q:nbs",""),i.style.display="none",n.appendChild(i),t[_]=i,i.click()}else location.reload()}else if(history.scrollRestoration==="manual"){const c=(r=history.state)==null?void 0:r[S];v(c),t[s]=!0}}},!t[y]){t[y]=!0;const o=history.pushState,r=history.replaceState,c=e=>(e===null||typeof e>"u"?e={}:(e==null?void 0:e.constructor)!==Object&&(e={_data:e}),e._qRouterScroll=e._qRouterScroll||m(),e);history.pushState=(e,n,i)=>(e=c(e),o.call(history,e,n,i)),history.replaceState=(e,n,i)=>(e=c(e),r.call(history,e,n,i))}t[d]=o=>{if(t[l]||o.defaultPrevented)return;const r=o.target.closest("a[href]");if(r&&!r.hasAttribute("preventdefault:click")){const c=r.getAttribute("href"),e=new URL(location.href),n=new URL(c,e),i=n.origin===e.origin,g=n.pathname+n.search===e.pathname+e.search;if(i&&g)if(o.preventDefault(),n.href!==e.href&&history.pushState(null,"",n),!n.hash)n.href.endsWith("#")?window.scrollTo(0,0):(t[s]=!1,clearTimeout(t[a]),u({...m(),x:0,y:0}),location.reload());else{const w=n.hash.slice(1),q=document.getElementById(w);q&&q.scrollIntoView()}}},t[f]=()=>{!t[l]&&t[s]&&document.visibilityState==="hidden"&&u()},t[p]=()=>{t[l]||!t[s]||(clearTimeout(t[a]),t[a]=setTimeout(()=>{u(),t[a]=void 0},200))},t[s]=!0,setTimeout(()=>{addEventListener("popstate",t[h]),addEventListener("scroll",t[p],{passive:!0}),document.body.addEventListener("click",t[d]),t.navigation||document.addEventListener("visibilitychange",t[f],{passive:!0})},0)}};export{k as s_HkmBRwr9Hwo};
